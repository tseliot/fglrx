#!/bin/sh

set -e

filename="$1"

[ -e "$filename" ] || {
    echo "USAGE: $0 path/to/fglrxko_pci_ids.h" >&2
    exit 1
}

echo "# Listing generated by fglrx_supported. Do not edit manually."

grep "0x" "$filename" | \
  sed -n 's/FGL_ASIC_ID(0x\([0-9A-F]\{4\}\)),$/alias pci:v00001002d0000\1sv*sd*bc03sc*i* fglrx fglrx/p' | \
  sort | uniq | sed -e 's/^[ \t]*//'
